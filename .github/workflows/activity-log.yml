name: ğŸš€ Auto Update Activity Log

on:
  push:
    branches:
      - main
  # å»ºè­°åŠ ä¸Š scheduleï¼Œç¢ºä¿æ´»å‹•èƒ½å®šæ™‚æ›´æ–°ï¼Œå³ä½¿æ²’æœ‰æ–°çš„ push
  schedule:
    - cron: '0 0 * * *' # æ¯æ—¥åˆå¤œåŸ·è¡Œä¸€æ¬¡
  workflow_dispatch:

# æ¬Šé™ï¼šå¿…é ˆæœ‰å¯«å…¥æ¬Šé™æ‰èƒ½ä¿®æ”¹ README.md
permissions:
  contents: write

jobs:
  update-readme:
    runs-on: ubuntu-latest
    
    # ã€ä¿®æ­£ 2ï¼šé˜²æ­¢ Action è‡ªèº«æäº¤é‡è¤‡è§¸ç™¼ã€‘
    # åƒ…ç•¶æäº¤è€…ä¸æ˜¯ GitHub Bot æ™‚æ‰é‹è¡Œï¼Œé¿å…ç„¡é™å¾ªç’°
    if: github.actor != 'github-actions[bot]'

    steps:
      - name: â¬‡ï¸ Checkout Repository Code
        uses: actions/checkout@v4
        # ä½¿ç”¨ PAT Token é€²è¡Œ Checkoutï¼Œè®“å¾ŒçºŒæ“ä½œèƒ½è®€å–ç§æœ‰ repo çš„æ´»å‹•
        with:
          token: ${{ secrets.TOKEN }} # ä½¿ç”¨æ‚¨è¨­å®šçš„ PAT Secret
          fetch-depth: 0
          
      - name: ğŸƒâ€â™‚ï¸ Run Activity Log Generator
        uses: TheDanniCraft/activity-log@v1
        with:
          # ã€ä¿®æ­£ 1ï¼šå°‡ GITHUB_USERNAME ç§»åˆ° with å€å¡Šã€‘
          # æ­¤ Action é æœŸ GITHUB_USERNAME ç‚ºè¼¸å…¥åƒæ•¸ (input)ï¼Œè€Œä¸æ˜¯ç’°å¢ƒè®Šæ•¸ (env)
          GITHUB_USERNAME: YiSanChen # æ›¿æ›ç‚ºæ‚¨çš„å¯¦éš› GitHub ä½¿ç”¨è€…åç¨±

          # é€™æ˜¯ç”¨æ–¼ API è«‹æ±‚çš„ Tokenã€‚é€™è£¡æ‡‰è©²ä½¿ç”¨æ‚¨è¨­å®šçš„ PAT Secret (TOKEN)
          TOKEN: ${{ secrets.TOKEN }}
          
          # å»ºè­°åŠ ä¸Š SECTION_NAMEï¼Œç¢ºä¿ Action çŸ¥é“è¦æ›¿æ›çš„å€å¡Š
          SECTION_NAME: activity 
          
      - name: ğŸ”„ Commit Updated README
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "ğŸ¤– Auto: Update activity log in README [skip ci]"
          commit_user_name: 'github-actions[bot]'
          commit_user_email: '41898282+github-actions[bot]@users.noreply.github.com'
          files: 'README.md'
          # ä½¿ç”¨é è¨­çš„ GITHUB_TOKENï¼Œæ­¤ Action æäº¤æ™‚æœƒè‡ªå‹•ä½¿ç”¨ Bot å¸³è™Ÿï¼Œ
          # ä¸”ä¸æœƒå†æ¬¡è§¸ç™¼ push eventï¼Œä½†ç‚ºç¢ºä¿æ¬Šé™ï¼Œé€™è£¡ä»å»ºè­°ä½¿ç”¨æ‚¨çš„ PAT
          token: ${{ secrets.TOKEN }}
