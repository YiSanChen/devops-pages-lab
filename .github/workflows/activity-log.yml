name: ğŸš€ Auto Update Activity Log

on:
  # åƒ…ä¿ç•™æ’ç¨‹å’Œæ‰‹å‹•è§¸ç™¼ (workflow_dispatch)ï¼Œ
  # ç§»é™¤ on: push å¯¦ç¾æ›´æ¸…æ½”çš„ CI/CD æµç¨‹æ§åˆ¶ã€‚
  schedule:
    # æ¯æ—¥å…©æ¬¡åŸ·è¡Œï¼šæ—©ä¸Š 8 é»å’Œ æ™šä¸Š 8 é» (UTC)
    - cron: '0 8,20 * * *' 
  workflow_dispatch:

permissions:
  contents: write

jobs:
  update-readme:
    runs-on: ubuntu-latest
    
    # ç”±æ–¼ç§»é™¤äº† on: pushï¼Œæ­¤ if æ¢ä»¶å…¶å¯¦å·²éå¿…è¦ï¼Œä½†ä¿ç•™å®ƒä½œç‚ºé˜²ç¦¦æ€§ç·¨ç¨‹ (Defensive Coding) ç¯„ä¾‹ã€‚
    if: github.actor != 'github-actions[bot]'

    steps:
      - name: â¬‡ï¸ Checkout Repository Code with PAT
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.TOKEN }} 
          fetch-depth: 0
          
      - name: ğŸƒâ€â™‚ï¸ Run Activity Log Generator
        uses: TheDanniCraft/activity-log@v1
        with:
          GITHUB_USERNAME: YiSanChen 
          GITHUB_TOKEN: ${{ secrets.TOKEN }}

      - name: ğŸ”„ Commit Updated README
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "ğŸ¤– Auto: Update activity log in README [skip ci]"
          commit_user_name: 'github-actions[bot]'
          commit_user_email: '41898282+github-actions[bot]@users.noreply.github.com'
          files: 'README.md'
          token: ${{ secrets.TOKEN }}
