name: 🚀 Auto Update Activity Log

on:
  # 僅保留排程和手動觸發 (workflow_dispatch)，
  # 移除 on: push 實現更清潔的 CI/CD 流程控制。
  schedule:
    # 每日兩次執行：早上 8 點和 晚上 8 點 (UTC)
    - cron: '0 8,20 * * *' 
  workflow_dispatch:

permissions:
  contents: write

jobs:
  update-readme:
    runs-on: ubuntu-latest
    
    # 由於移除了 on: push，此 if 條件其實已非必要，但保留它作為防禦性編程 (Defensive Coding) 範例。
    if: github.actor != 'github-actions[bot]'

    steps:
      - name: ⬇️ Checkout Repository Code with PAT
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.TOKEN }} 
          fetch-depth: 0
          
      - name: 🏃‍♂️ Run Activity Log Generator
        uses: TheDanniCraft/activity-log@v1
        with:
          GITHUB_USERNAME: YiSanChen 
          GITHUB_TOKEN: ${{ secrets.TOKEN }}

      - name: 🔄 Commit Updated README
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "🤖 Auto: Update activity log in README [skip ci]"
          commit_user_name: 'github-actions[bot]'
          commit_user_email: '41898282+github-actions[bot]@users.noreply.github.com'
          files: 'README.md'
          token: ${{ secrets.TOKEN }}
